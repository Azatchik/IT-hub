"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[600],{1781:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var r=n(5893),i=n(4611),a=n(2327),o=n(7294),s=n(5949),c=n(6974),l=n(4809);const u={comment:"zo5NFi5H"};var d=n(71),f=n(1138),v=n(3048),h=n(8046);const m="xIHByGcu",p="dsH_3Oqu",y="Ks7Kyp_K",b="dw82WMzO";var x=function(){return x=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},x.apply(this,arguments)},g=(0,o.memo)((function(e){var t=e.className,n=e.comment;return e.isLoading?(0,r.jsxs)("div",x({className:(0,i.A)(m,{},[t,"V0iZ1Un3"])},{children:[(0,r.jsxs)("div",x({className:p},{children:[(0,r.jsx)(f.O,{width:30,height:30,border:"50%"},void 0),(0,r.jsx)(f.O,{height:16,width:100,className:b},void 0)]}),void 0),(0,r.jsx)(f.O,{className:y,width:"100%",height:50},void 0)]}),void 0):n?(0,r.jsxs)("div",x({className:(0,i.A)(m,{},[t])},{children:[(0,r.jsxs)(v.F,x({to:"".concat(h.h3.profile).concat(n.user.id),className:p},{children:[n.user.avatar?(0,r.jsx)(d.q,{size:30,src:n.user.avatar},void 0):null,(0,r.jsx)(l.xv,{className:b,title:n.user.username},void 0)]}),void 0),(0,r.jsx)(l.xv,{className:y,text:n.text},void 0)]}),void 0):null})),w=function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},w.apply(this,arguments)},j=(0,o.memo)((function(e){var t=e.className,n=e.isLoading,o=e.comments,s=(0,a.$)().t;return n?(0,r.jsxs)("div",w({className:(0,i.A)(u.CommentList,{},[t])},{children:[(0,r.jsx)(g,{isLoading:!0},void 0),(0,r.jsx)(g,{isLoading:!0},void 0),(0,r.jsx)(g,{isLoading:!0},void 0)]}),void 0):(0,r.jsx)("div",w({className:(0,i.A)(u.CommentList,{},[t])},{children:(null==o?void 0:o.length)?o.map((function(e){return(0,r.jsx)(g,{isLoading:n,className:u.comment,comment:e},e.id)})):(0,r.jsx)(l.xv,{text:s("Комментарии отсутствуют")},void 0)}),void 0)})),N=n(1150),L=n(9704),k=n(2276),S=(0,o.lazy)((function(){return new Promise((function(e){setTimeout((function(){return e(n.e(102).then(n.bind(n,102)))}),1500)}))})),C=n(314),O=n(9161),P=n(3574);var A=(0,n(573).P1)(s.wq,P.m5,(function(e,t){return!(!e||!t)&&e.user.id===t.id})),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D.apply(this,arguments)},I=(0,o.memo)((function(e){var t=e.className,n=(0,a.$)().t,l=(0,c.s0)(),u=((0,L.v9)(P.m5),(0,L.v9)(s.wq)),d=(0,L.v9)(A),f=(0,o.useCallback)((function(){l(h.h3.articles)}),[l]),v=(0,o.useCallback)((function(){l(h.h3.article_edit.replace(":id",(null==u?void 0:u.id)||""))}),[null==u?void 0:u.id,l]);return(0,r.jsxs)("div",D({className:(0,i.A)("PF3DYqSS",{},[t])},{children:[(0,r.jsx)(O.zx,D({theme:O.bn.OUTLINE,onClick:f},{children:n("Назад к списку")}),void 0),d&&(0,r.jsx)(O.zx,D({className:"XdnP3e6a",theme:O.bn.OUTLINE,onClick:v},{children:n("Редактировать")}),void 0)]}),void 0)})),E=n(7779),z=n(6403),T=(0,z.hg)("articleDetails/fetchCommentsByArticleId",(function(e,t){return n=void 0,r=void 0,a=function(){var n,r,i;return function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(a){switch(a.label){case 0:if(n=t.extra,r=t.rejectWithValue,!e)return[2,r("error")];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.api.get("/comments",{params:{articleId:e,_expand:"user"}})];case 2:if(!(i=a.sent()).data)throw new Error;return[2,i.data];case 3:return a.sent(),[2,r("error")];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,s)}c((a=a.apply(n,r||[])).next())}));var n,r,i,a})),_=(0,z.HF)({selectId:function(e){return e.id}}),H=_.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments)||_.getInitialState()})),q=(0,z.oM)({name:"articleDetailsCommentsSlice",initialState:_.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(T.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(T.fulfilled,(function(e,t){e.isLoading=!1,_.setAll(e,t.payload)})).addCase(T.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,F=(0,z.hg)("articlesDetailsPage/fetchArticleRecommendations",(function(e,t){return n=void 0,r=void 0,a=function(){var e,n,r;return function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(i){switch(i.label){case 0:e=t.extra,n=t.rejectWithValue,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.api.get("/articles",{params:{_limit:8}})];case 2:if(!(r=i.sent()).data)throw new Error;return[2,r.data];case 3:return i.sent(),[2,n("error")];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,s)}c((a=a.apply(n,r||[])).next())}));var n,r,i,a})),U=(0,z.HF)({selectId:function(e){return e.id}}),G=U.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||U.getInitialState()})),W=(0,z.oM)({name:"articleDetailsPageRecommendationsSlice",initialState:U.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(F.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(F.fulfilled,(function(e,t){e.isLoading=!1,U.setAll(e,t.payload)})).addCase(F.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,M=(0,E.UY)({comments:q,recommendations:W}),R=function(e){var t,n;return null===(n=null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||void 0===n?void 0:n.isLoading},V=n(3101),K=(0,z.hg)("articleDetails/addCommentForArticle",(function(e,t){return n=void 0,r=void 0,a=function(){var n,r,i,a,o,s,c;return function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(l){switch(l.label){case 0:if(n=t.extra,r=t.dispatch,i=t.rejectWithValue,a=t.getState,o=(0,P.m5)(a()),s=(0,V.wq)(a()),!o||!e||!s)return[2,i("no data")];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.api.post("/comments",{articleId:s.id,userId:o.id,text:e})];case 2:if(!(c=l.sent()).data)throw new Error;return r(T(s.id)),[2,c.data];case 3:return l.sent(),[2,i("error")];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,s)}c((a=a.apply(n,r||[])).next())}));var n,r,i,a})),$=function(e){var t;return null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments.isLoading};const B="adu8fSDx",Q="foyEsCeG";var Y=function(){return Y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Y.apply(this,arguments)},X={articleDetailsPage:M},Z=function(e){var t=e.className,n=(0,a.$)("article-details").t,u=(0,c.UO)().id,d=(0,L.I0)(),f=(0,L.v9)(H.selectAll),v=(0,L.v9)(G.selectAll),h=(0,L.v9)($),m=(0,L.v9)(R),p=(0,o.useCallback)((function(e){d(K(e))}),[d]);return(0,k.Q)((function(){d(T(u)),d(F())})),u?(0,r.jsx)(N.W,Y({reducers:X,removeAfterUnmount:!0},{children:(0,r.jsxs)(C.T,Y({className:(0,i.A)(B,{},[t])},{children:[(0,r.jsx)(I,{},void 0),(0,r.jsx)(s.D0,{id:u},void 0),(0,r.jsx)(l.xv,{size:l.yH.L,className:Q,title:n("Рекомендуем")},void 0),(0,r.jsx)(s.wD,{articles:v.sort((function(){return Math.random()-.5})),isLoading:m,className:"NwQlSikL",target:"_blank"},void 0),(0,r.jsx)(l.xv,{size:l.yH.L,className:Q,title:n("Комментарии")},void 0),(0,r.jsx)(S,{onSendComment:p},void 0),(0,r.jsx)(j,{isLoading:h,comments:f},void 0)]}),void 0)}),void 0):(0,r.jsx)(C.T,Y({className:(0,i.A)(B,{},[t])},{children:n("Статья не найдена")}),void 0)};const J=(0,o.memo)(Z)}}]);